Training a Network
===
>This manual will explain the process of how to train a network. This essentially takes a batch of images and their corresponding traces and helps train Autotrace to better predict contours of the tongue.

Select ROI
---
 >This script is designed to help the user select a region of interest
	to use with the set of images selected by the user. The boundaries
	can be set either by clicking and dragging, or with the text entry
	boxes. When this script is run, it will look for a config file called
	ROI_config.txt that specifies the region of interest. If no such file
	exists, it will be created when the user presses 'Save'. Saving will
	overwrite any previous information in ROI_config.txt.
	ROI_config.txt will be used by other scripts, such as image_diversity.py,
	Autotrace.py, and TrainNetwork.py.

+ Open __Select ROI__
+ To do this open the __terminal__
+ Open a new tab within the __terminal__
+ Change to the Autotrace directory (ex.`cd /path/to/Autotrace/old`)

+ Start [SelectROI.py](../SelectROI.py) by typing `python SelectROI.py`
+ The terminal will open followed by an __Open Image Files__ screen.
![Image1SR](images/Image1SR.png)
+ Select the images you would like to average and click __open__
+ Once the window is open, box the area you are interested in investigating, select the machine you are using, and click __save__.
+ Then select a location to put the ROI_config.txt and click __save__.
+ When finished, click __Exit Program__

Image Diversity NEW
---

>This script measures the distance from average for each image in the
	input set, and copies the specified number of highest scoring images
	to a new folder called 'diverse'. If ROI_config.txt is present in the
	same folder as the input images, the ROI in that file will be used to
	do the measurement. If not present, it will use a hard-coded default ROI.

+ Open [Image Diversity](../image_diversityNEW.py) by typing `python image_diversityNEW.py`

![Image Diversity](images/image_diversityNEW.png)

+ Click _open_ by the Select Files field
 >Note: this program filters so that only images can be selected, and once you click _open_ it may take a while.
+ It will then ask for corresponding traces to match the images
+ Hit _open_ once you have selected the corresponding traces
+ The main screen tells the number of images selected
+ Specify the number for training and testing
 >_training_ is the first time it runs through, and then the number you _test_ comes from the _training_ batch
+ specify the numer of _most diverse_ and _least diverse_
 > _most diverse_ will select images that vary greatly in their tongue contours, while _least diverse_ will select images that all have similar tongue contours

 + That will reduce the numbr of overall images based on your specifications
+ Select the ratio of _most diverse_ to _least diverse_
+ From this you can select a __test set__. It is recommended that you use a sample from your most diverse images for testing.
+ __batches for remaining__ is simply all of the images that you have not selected to train with, and they will go into a folderentitled __remaining__
 > Note: if an __error__ during this part of the process occurs then some settings may be missing
+ Save to your folder of choice
+ Click __OK__
+ From this a graph will open
![Image Diversity Graph](images/image_diversityNEWgraph.png)
 > This shows __Diversity Scores__ on the Y axis. Diversity scores will be higher if you have more diverse images and vice versa for least diverse. On the X axis it simply ranks the numbers based on their order.

 + You can save this graph if you would like or take a screenshot
>The program will close automatically when it is done running (T: may not be correct, program has not closed automatically for me yet)
+ Open the folder where you specified to have the images
 > Note: In this folder there will be several other new folders. __batch remaining__ is the folder discussed above. __diversity log__ is the record of what happened in the file move. __sorted results__ are the scores for each image.

Configdir
---

>This script arranges training data into the directory
    structure that TrainNetwork.py expects.

+ run [configdir.py](../configdir.py) by typing `python configdir.py`

![configdir](images/configdir.png)
+ Select the _train_ directory created by ImageDiversity

![configdir2](images/configdir2.png)
+ Running this script produces the directories __Subject1/__, __traces/__ and __Subject1/IMAGES/__, as well as __TongueContours.csv__.
+ __ROI_config.txt__    is moved into __Subject1/__.

Train Network
---

>there are two versions of __Train Network__. For this we will be using __Train Network 2__

 + In the `Autotrace/matlab-version` directory, Launch __Train Network 2__ with the following command `python TrainNetwork2.py`

 ![TrainNetwork2](images/TrainNetwork2.png) 
 + In the __Data__ dropdown menu, specify the training data that is compiled in the folder by clicking on the subject's folder then clicking _open_
  + Be sure to select both the __images__ and __traces__ folders. 
  + Check that __ROI_config.txt__ is in the Subject1/ folder
 + Select __send email notification__

 > This will send an email once the program is done running. It may take hours or even days depending on the system, number of images, an other variables. You should adjust your settings so that your computer does not fall asleep.

 > For further information on this program and the other programs mentioned above, you should refer to the dissertation by Jeff Berry.

Autotrace
---
 + Open __Autotrace__ with the command `python Autotrace.py`
 ![Autotrace1](images/Autotrace1.png)
 + Click the second icon from the left, "Load Network"
 ![Autotrace2](images/Autotrace2.png)
 + Select the _network.mat_ file in the _savefiles_ directory in your Autotrace folder and click _open_. 
![Autotrace3](images/Autotrace3.png) 
 + Click the leftmost icon, "Load Images", select a test set of images and click _open_
 + Click the "gears" icon to begin tracing the images. At this point, __Matlab__ will start. You will see a notification window when it is finished. 

